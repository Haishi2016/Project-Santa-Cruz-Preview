{
  "modulesContent": {
    "$edgeAgent": {
      "properties.desired": {
        "modules": {
          "WebStreamModule": {
            "settings": {
              "image": "azureedgedevices.azurecr.io/webstreammodule:preload-devkit",
              "createOptions": "{\"ExposedPorts\":{\"3000/tcp\":{},\"3002/tcp\":{}},\"HostConfig\":{\"PortBindings\":{\"3000/tcp\":[{\"HostPort\":\"3000\"}],\"3002/tcp\":[{\"HostPort\":\"3002\"}]}}}"
            },
            "type": "docker",
            "version": "1.0",
            "env": {
              "RTSP_IP": {
                "value": "azureeyemodule"
              },
              "RTSP_PORT": {
                "value": "8554"
              },
              "RTSP_PATH": {
                "value": "result"
              }
            },
            "status": "running",
            "restartPolicy": "always"
          },
          "devmmclientmodule": {
            "settings": {
              "image": "azureedgedevices.azurecr.io/devmmclientmodule:preload-devkit",
              "createOptions": "{\"HostConfig\":{\"Privileged\":true,\"Binds\":[\"/dev:/dev\"]}}"
            },
            "type": "docker",
            "version": "1.0",
            "status": "running",
            "restartPolicy": "always"
          },
          "azureearspeechclientmodule": {
            "settings": {
              "image": "azureedgedevices.azurecr.io/azureearspeechclientmodule:preload-devkit",
              "createOptions": "{\"HostConfig\":{\"Privileged\":true,\"Binds\":[\"/dev:/dev\"]}}"
            },
            "type": "docker",
            "version": "1.0",
            "status": "running",
            "restartPolicy": "always"
          },
          "azureeyemodule": {
            "settings": {
              "image": "devazureedgedevices.azurecr.io/securedazureeyemodule:latest-arm64v8",
              "createOptions": "{\"ExposedPorts\":{\"8554/tcp\":{}},\"HostConfig\":{\"Binds\":[\"/dev/bus/usb:/dev/bus/usb\"],\"Privileged\":true,\"DeviceCgroupRules\":[\"c 189:* rmw\"],\"PortBindings\":{\"8554/tcp\":[{\"HostPort\":\"8554\"}]}}}"
            },
            "type": "docker",
            "version": "1.0",
            "status": "running",
            "restartPolicy": "always",
            "env": {
              "AZURE_CLIENT_ID": {
                "value": "$AZURE_CLIENT_ID"
              },
              "AZURE_CLIENT_SECRET": {
                "value": "$AZURE_CLIENT_SECRET"
              },
              "AZURE_TENANT_ID": {
                "value": "$AZURE_TENANT_ID"
              },
              "CONFIDENCE_THRESHOLD": {
                "value": "$CONFIDENCE_THRESHOLD"
              }
            }
          }
        },
        "runtime": {
          "settings": {
            "minDockerVersion": "v1.25",
            "registryCredentials": {
              "devazureedgedevices": {
                "address": "devazureedgedevices.azurecr.io",
                "password": "ktzvl+HNCvws6MoD4oxTvedIoLxY5xDX",
                "username": "internalpull"
            },
            "azureedgedevices": {
                "address": "azureedgedevices.azurecr.io",
                "password": "wq7=cdwBX1X9l/wSNwFpRblS6+YP2NzZ",
                "username": "devkitprivatepreviewpull"
            }
            }
          },
          "type": "docker"
        },
        "schemaVersion": "1.0",
        "systemModules": {
          "edgeAgent": {
            "settings": {
              "image": "mcr.microsoft.com/azureiotedge-agent:1.0",
              "createOptions": "{}"
            },
            "type": "docker",
            "env": {
              "BackupConfigFilePath": {
                "value": "/tmp/edgeAgent/backup.json"
              }
            }
          },
          "edgeHub": {
            "settings": {
              "image": "mcr.microsoft.com/azureiotedge-hub:1.0",
              "createOptions": "{\"HostConfig\":{\"PortBindings\":{\"5671/tcp\":[{\"HostPort\":\"5671\"}],\"8883/tcp\":[{\"HostPort\":\"8883\"}]}}}"
            },
            "type": "docker",
            "env": {
              "OptimizeForPerformance": {
                "value": "False"
              },
              "mqttSettings__ThreadCount": {
                "value": "4"
              }
            },
            "status": "running",
            "restartPolicy": "always"
          }
        }
      }
    },
    "$edgeHub": {
      "properties.desired": {
        "routes": {
          "AzureEyeModuleToIoTHub": "FROM /messages/modules/azureeyemodule/outputs/* INTO $upstream",
          "AzureSpeechToIoTHub": "FROM /messages/modules/azureearspeechclientmodule/outputs/* INTO $upstream"
        },
        "schemaVersion": "1.0",
        "storeAndForwardConfiguration": {
          "timeToLiveSecs": 7200
        }
      }
    },
    "WebStreamModule": {
      "properties.desired": {}
    },
    "devmmclientmodule": {
      "properties.desired": {}
    },
    "azureearspeechclientmodule": {
      "properties.desired": {
        "speechConfigs": {
          "appId": "",
          "key": "",
          "region": "",
          "keywordModelUrl": "https://aedspeechscenarios.blob.core.windows.net/keyword-tables/computer.table",
          "keyword": "computer",
          "skillType": "xxx",
          "speechLogFile": "speech.log"
        },
        "deviceConfigs": {
          "volume": 45,
          "enableSendAppLog": false
        }
      }
    },
    "azureeyemodule": {
      "properties.desired": {
        "Logging": true,
        "ModelZipUrl": "",
        "RawStream": true,
        "ResultStream": true,
        "Running": true,
        "TelemetryInterval": 10,
        "SecureAILifecycleEnabled": true, 
        "SCZ_MODEL_NAME": "$SCZ_MODEL_NAME",
        "SCZ_MODEL_VERSION": "$SCZ_MODEL_VERSION",
        "SCZ_MM_SERVER_URL": "$SCZ_MM_SERVER_URL",
        "RetrainingDataCollectionEnabled": false,
        "RetrainingDataCollectionInterval": 60
      }
    }
  }
}